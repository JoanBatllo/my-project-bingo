services:
  persistence:
    build:
      context: ./persistence
      dockerfile: Dockerfile
    image: my-project-bingo-persistence:latest
    environment:
      PYTHONUNBUFFERED: "1"
      PYTHONDONTWRITEBYTECODE: "1"
      API_HOST: 0.0.0.0
      API_PORT: 8000
      BINGO_DB_PATH: /app/data/bingo.db
    ports:
      - "8000:8000"
    volumes:
      - ./persistence/data:/app/data
    networks:
      - bingo-network

  bingo-game:
    build:
      context: ./game
      dockerfile: Dockerfile
    image: my-project-bingo-game:latest
    environment:
      PYTHONUNBUFFERED: "1"
      PYTHONDONTWRITEBYTECODE: "1"
      STREAMLIT_BROWSER_GATHER_USAGE_STATS: "false"
      STREAMLIT_ADDRESS: 0.0.0.0
      STREAMLIT_PORT: 8501
      PERSISTENCE_URL: http://persistence:8000
    depends_on:
      - persistence
    ports:
      - "8501:8501"
    networks:
      - bingo-network

networks:
  bingo-network:
    driver: bridge
